# ğŸ“Œ Android Malicious Indicator Scanner  

**Detects suspicious indicators in extracted APK strings**  

ğŸ”¹ **Author**: L0WK3Y  
ğŸ”¹ **Category**: Mobile Reverse Engineering / Malware Analysis  
ğŸ”¹ **License**: MIT  

---

## ğŸ¯ Overview  

The **Android Malicious Indicator Scanner** analyzes extracted strings from an **Android APK** to identify **suspicious behaviors**, such as:  

âœ… **C2 URLs, IPs, and domains**  
âœ… **Sensitive permissions** (e.g., `READ_SMS`, `CALL_PHONE`)  
âœ… **Obfuscation & encryption methods** (e.g., `Base64`, `AES`, `XOR`)  
âœ… **Anti-debugging & emulator detection**  
âœ… **Dynamic code loading & native execution**  
âœ… **Reflection-based evasion techniques**  
âœ… **Potential root detection methods**  
âœ… **High-entropy data (possible encrypted payloads)**  

The script reads extracted string data from a **CSV file** (generated by `string_extraction.py`), scans for indicators, and outputs findings in a structured **rich**-formatted table and **CSV report**.

---

## ğŸ› ï¸ Features  

### ğŸ” **Scans CSV Output from `string_extraction.py`**  
- Automatically lists available CSV files in `src/output/`  
- Prompts user to select a CSV for analysis  

### ğŸš¨ **Identifies Suspicious Indicators**  
- **Permissions**: Extracts and checks for **dangerous** Android permissions  
- **Obfuscation**: Flags Base64, XOR, AES, RC4, and reflection usage  
- **Anti-debugging**: Detects emulator checks and debugger detection  
- **Dynamic Code Loading**: Identifies `DexClassLoader`, `Method.invoke`, and `.dex` loading  
- **Malicious API Calls**: Finds `exec()`, WebView injection, and socket connections  
- **Hidden Asset Manipulation**: Flags access to encrypted assets or payloads  
- **Root Detection**: Identifies system property checks for rooted environments  

### ğŸ“Š **Structured Output & Report Generation**  
- **Findings displayed** in a color-coded, rich-formatted table  
- **Duplicates removed** automatically  
- **Results saved as `potential_indicators.csv`** in the output directory  

---

## ğŸ”§ Usage  

### **Run the Script**  
To analyze a CSV for malicious indicators:  

```sh
python malicious_indicator_detection.py
```

### **What It Does**  

1ï¸âƒ£ **Finds all extracted string CSV files** in `src/output/`  
2ï¸âƒ£ **Lists available CSVs** and prompts the user to pick one  
3ï¸âƒ£ **Scans for malicious indicators** in APK-extracted strings  
4ï¸âƒ£ **Displays findings** in a structured table  
5ï¸âƒ£ **Saves results** as `potential_indicators.csv` in the same directory  

---

## ğŸ“„ Example Output  

```sh
ğŸ” Android Malicious Indicator Scanner ğŸ”

ğŸ“„ Found the following CSV files:
   [1] src/output/malicious_app_strings.csv
   [2] src/output/clean_app_strings.csv

[?] Enter the number of the CSV file to analyze: 1

ğŸ” Scanning CSV: src/output/malicious_app_strings.csv...

ğŸš¨ Permissions Detected:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File                                  â”‚ Suspicious String             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ src/output/malicious_app_strings.csv  â”‚ android.permission.READ_SMS   â”‚
â”‚ src/output/malicious_app_strings.csv  â”‚ android.permission.CALL_PHONE â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸš¨ Obfuscation Methods Detected:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File                                  â”‚ Suspicious String         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ src/output/malicious_app_strings.csv  â”‚ Base64.decode             â”‚
â”‚ src/output/malicious_app_strings.csv  â”‚ DexClassLoader            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Findings saved to: src/output/potential_indicators.csv
```

---

## âš ï¸ Indicators Detected  

### **ğŸ“œ Permissions**  
Flags Android permissions that could be abused:  
- `READ_SMS`, `RECEIVE_SMS` â†’ **Stealing messages**  
- `CALL_PHONE` â†’ **Silent dialing / premium calls**  
- `READ_CONTACTS` â†’ **Harvesting contact lists**  
- `INTERNET` â†’ **Exfiltrating stolen data**  
- `BIND_DEVICE_ADMIN` â†’ **Persistent malware (Device Admin)**  
- `SYSTEM_ALERT_WINDOW` â†’ **Overlay attacks (e.g., phishing screens)**  

### **ğŸ›¡ï¸ Anti-Debugging & Emulator Detection**  
Identifies techniques to detect emulation and prevent analysis:  
- `isDebuggerConnected()`, `android.os.Debug.waitForDebugger()`  
- Checks for **QEMU properties** (emulator detection)  
- Uses **Build.FINGERPRINT, Build.MODEL** for device checks  

### **ğŸ” Obfuscation & Encryption**  
Flags use of:  
- **Base64, XOR, AES, RC4, MD5** (common for encrypted payloads)  
- **Reflection-based execution** (`Class.forName`, `Method.invoke`)  
- **Dynamic Code Loading** (`DexClassLoader`, `.dex` loading)  

### **ğŸ“¡ Suspicious API Calls**  
Flags network activity, process execution, and dynamic loading:  
- `java.net.Socket` â†’ **Creates suspicious network connections**  
- `java.lang.Runtime.exec()` â†’ **Executes system commands**  
- `android.webkit.WebView.loadUrl()` â†’ **Injects malicious JavaScript**  

### **ğŸ­ Hidden Asset & File Manipulation**  
Flags access to hidden files, assets, and encrypted payloads:  
- `getAssets()`, `getResources()`, `openRawResource()`  
- Dynamic resource loading via `getIdentifier()`  

### **ğŸ´ Root Detection**  
Detects techniques used by apps to check for **rooted devices**:  
- `invoke-static {}, Ljava/lang/System;->getProperty("ro.secure")`  
- Checks for **banned su binary paths**  

---

## ğŸ“Œ Advanced Features  

### **Entropy-Based Analysis**  
âœ… Scans for **high-entropy data** (Base64, AES-encrypted payloads)  
âœ… Ignores common files like `.smali` and `.xml`  

### **XOR Obfuscation Detection (Dynamic)**  
âœ… Detects `xor-(int|long|byte|short)` operations in **Smali**  
âœ… Identifies XOR **key usage** (constant/variable-based obfuscation)  

### **CSV Management**  
âœ… **Skips duplicate entries** from subfolders  
âœ… **Ignores previously scanned results** (`potential_indicators.csv`)  

---

## ğŸ´â€â˜ ï¸ Use Cases  

âœ… **Pentesting** â€“ Identify malicious APK behavior and C2 communication  
âœ… **Reverse Engineering** â€“ Extract obfuscation techniques and encryption methods  
âœ… **Malware Analysis** â€“ Flag anti-analysis and persistence techniques  
âœ… **Threat Hunting** â€“ Detect backdoors, hidden execution, and privilege escalation  

---

## âš™ï¸ Troubleshooting  

### âŒ **No CSV files found!**  
ğŸ”¹ **Fix:** Run `string_extraction.py` first to generate an extracted strings CSV.  

```sh
python string_extraction.py
python malicious_indicator_detection.py
```

### âŒ **No suspicious indicators found!**  
ğŸ”¹ **Fix:** The scanned APK may not contain obvious malicious indicators.  
ğŸ”¹ Try analyzing another CSV file or reviewing extracted strings manually.  

### âŒ **Rich module not found!**  
ğŸ”¹ **Fix:** Install the required Python module for enhanced UI.  

```sh
pip install rich
```

---

## ğŸ“œ License  
This project is licensed under the **MIT License** â€“ feel free to modify and use it as needed.  

---

## ğŸ¤ Contributing  
ğŸ’¡ **Want to improve this tool?** Open an issue or submit a pull request!  


Happy Hunting! ğŸš€